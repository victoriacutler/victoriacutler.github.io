<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Victoria Cutler">
<meta name="dcterms.date" content="2023-07-27">
<meta name="description" content="Teasing out causation from correlation using difference-in-differences analysis.">

<title>Correlation vs Causation: Air Quality and Housing Prices</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html">blog &amp; portfolio</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ethics.html">ethics</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume/vc_resume.pdf">resume</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/victoriacutler"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/VictoriaECutler"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/victoria-cutler/"><i class="bi bi-linkedin" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:victoriacutler123@gmail.com"><i class="bi bi-envelope" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Correlation vs Causation: Air Quality and Housing Prices</h1>
                  <div>
        <div class="description">
          Teasing out causation from correlation using difference-in-differences analysis.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">LINEAR REGRESSION</div>
                <div class="quarto-category">CAUSATION</div>
                <div class="quarto-category">EQUITY</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <a href="https://victoriacutler.github.io">Victoria Cutler</a> 
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://ucsb-meds.github.io">
              Master of Environmental Data Science at The Bren School (UCSB)
              </a>
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 27, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#how-can-we-differentiate-between-correlation-vs-causation" id="toc-how-can-we-differentiate-between-correlation-vs-causation" class="nav-link active" data-scroll-target="#how-can-we-differentiate-between-correlation-vs-causation">How Can We Differentiate Between Correlation vs Causation?</a></li>
  <li><a href="#the-code" id="toc-the-code" class="nav-link" data-scroll-target="#the-code">The Code</a>
  <ul class="collapse">
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries">Load Libraries</a></li>
  <li><a href="#read-in-the-data" id="toc-read-in-the-data" class="nav-link" data-scroll-target="#read-in-the-data">Read in the Data</a></li>
  <li><a href="#a-quick-data-exploration" id="toc-a-quick-data-exploration" class="nav-link" data-scroll-target="#a-quick-data-exploration">A Quick Data Exploration</a></li>
  <li><a href="#finding-causation-linear-regression-with-difference-in-differences-analysis" id="toc-finding-causation-linear-regression-with-difference-in-differences-analysis" class="nav-link" data-scroll-target="#finding-causation-linear-regression-with-difference-in-differences-analysis">Finding Causation: Linear Regression with Difference In Differences Analysis</a></li>
  </ul></li>
  <li><a href="#final-thoughts-on-incinerator-construction-in-north-andover." id="toc-final-thoughts-on-incinerator-construction-in-north-andover." class="nav-link" data-scroll-target="#final-thoughts-on-incinerator-construction-in-north-andover.">Final Thoughts on incinerator construction in North Andover.</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">




<section id="how-can-we-differentiate-between-correlation-vs-causation" class="level2">
<h2 class="anchored" data-anchor-id="how-can-we-differentiate-between-correlation-vs-causation">How Can We Differentiate Between Correlation vs Causation?</h2>
<p>Correlation can easily be confused with causation. Sometimes it’s not so obvious whether X causes Y, or if X and Y are just correlated and simply tied together by a different actor, Z.</p>
<p>For example: it’s plausable that people often get ice cream on days that they also end up getting sunburned. Would this mean that ice cream causes skin to burn? We know logically that people may get ice cream more on warm sunny days, and it’s these warm sunny days that cause the sunburns, not the ice cream. However, other problems are more nuanced an complex, and the answer may not be so obvious. How do we discern causation from correlation, then?</p>
<p><strong>The TLDR: we can use mathematics!</strong> Here, I use difference-in-differences analysis to determine whether or not proximity to an incinerator (a proxy for increased air pollution) causes a decrease in housing value. A key assumption we need validated in order to perform this analysis is called the parallel trends assumption.</p>
<p>For this assumption to hold water, we need to be fairly certain that if we had withheld treatment (i.e.&nbsp;if a nearby incinerator were never installed) the price of houses in the ‘treated’ group (i.e.&nbsp;houses that actually did end up nearby an incinerator) would have followed the same pricing trend as the ‘control’ group (i.e.&nbsp;houses that did end up far away from an incinerator). By controlling for other time invariant variables such as number of rooms, house size, and other attributes, I consider this assumption and analyses valid.</p>
</section>
<section id="the-code" class="level2">
<h2 class="anchored" data-anchor-id="the-code">The Code</h2>
<section id="load-libraries" class="level3">
<h3 class="anchored" data-anchor-id="load-libraries">Load Libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(formatR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-in-the-data" class="level3">
<h3 class="anchored" data-anchor-id="read-in-the-data">Read in the Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"posts"</span>,<span class="st">"correlation-vs-causation"</span>,<span class="st">"data"</span>, <span class="st">"KM_EDS241.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>raw_dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file_path) <span class="sc">|&gt;</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 321
Columns: 7
$ year    &lt;dbl&gt; 1978, 1978, 1978, 1978, 1978, 1978, 1978, 1978, 1978, 1978, 19…
$ age     &lt;dbl&gt; 48, 83, 58, 11, 48, 78, 22, 78, 42, 41, 78, 38, 18, 32, 18, 58…
$ rooms   &lt;dbl&gt; 7, 6, 6, 5, 5, 6, 6, 6, 8, 5, 6, 5, 6, 6, 6, 7, 6, 5, 4, 5, 4,…
$ area    &lt;dbl&gt; 1660, 2612, 1144, 1136, 1868, 1780, 1700, 1556, 1642, 1443, 14…
$ land    &lt;dbl&gt; 4578, 8370, 5000, 10000, 10000, 9500, 10878, 3870, 7000, 7950,…
$ nearinc &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1,…
$ rprice  &lt;dbl&gt; 60000, 40000, 34000, 63900, 44000, 46000, 56000, 38500, 60500,…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>clean_dat <span class="ot">&lt;-</span> raw_dat <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nearinc =</span> <span class="fu">as.factor</span>(nearinc)) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">known_nearinc =</span> <span class="fu">ifelse</span>(nearinc<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> year<span class="sc">==</span><span class="dv">1981</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">|&gt;</span>  <span class="co"># since in 1978, the incinerator location wasn't well known</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">known_nearinc =</span> <span class="fu">as.factor</span>(known_nearinc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-quick-data-exploration" class="level3">
<h3 class="anchored" data-anchor-id="a-quick-data-exploration">A Quick Data Exploration</h3>
<p>Looking at the housing data plotted into boxplot distributions, below, we see that houses known to be sited near an incinerator (dots on the right hand side) appear to have lower housing prices on average than those houses not known to be sited near an incinerator (dots on the left hand side). Is this because the incinerator location is correlated with lower housing values? (Perhaps the incinerator is sited on less expensive land, with less expensive homes.) Or, is this because close incinerator proximity <em>causes</em> lower housing values? (Perhaps because people do not want to buy homes in areas with worse air quality.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> clean_dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> known_nearinc, <span class="at">y =</span> rprice)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Known to be Near an Incinerator"</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Inflation-Adjusted House Selling Price"</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"House Selling Prices and Incinerator Proximity"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="finding-causation-linear-regression-with-difference-in-differences-analysis" class="level3">
<h3 class="anchored" data-anchor-id="finding-causation-linear-regression-with-difference-in-differences-analysis">Finding Causation: Linear Regression with Difference In Differences Analysis</h3>
<p>To help tease this out, we can use futher analysis that assumes that housing values would change at the same rate over time (from 1978 to 1981) if no incinerators ended up being built (this is called the parallel trends assumption) and look at the difference in differences between the effect of time on the ‘treated’ (houses with incinerators nearby) housing values vs the effect of time on the treated if the treated were assumed to have the same rate of change in housing values as the control (houses without incinerators nearby). This approach also effectively controls for any time-invariant omitted variables (like if something else like a policy change influencing housing prices across the board). We also control for other time variant variables that we have in our dataset that would otherwise create bias.</p>
<p>The <code>known_nearinc</code> variable effectively creates an indicator of 1 for the houses in 1981 with incinerators known to be nearby (our treatment group) and our control group is any other house (since, in 1978, it was not common knowledge that houses would be near an incinerator). And since we are controlling for the incinerator (with the <code>nearinc</code> variable), according to the parallel trends assumption, the treatment group and control group should have the same slope if there is no incinerator housing price effect. In other words, the coefficient on the <code>known_nearinc</code> should not be statistically significantly different from 0 (as a non-zero value would create different slopes).</p>
<p>Test the hypothesis that the coefficients on the house and lot characteristics are all jointly equal to 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression also controlling for house and lot characteristics in addition to year using heteroskedastic robust SE</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>lm_mod_all <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> rprice <span class="sc">~</span> known_nearinc <span class="sc">+</span> nearinc <span class="sc">+</span> <span class="fu">as.factor</span>(year) <span class="sc">+</span> age <span class="sc">+</span> rooms <span class="sc">+</span> area <span class="sc">+</span> land, <span class="at">data =</span> clean_dat)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>se_lmmod_all <span class="ot">&lt;-</span> <span class="fu">starprep</span>(lm_mod_all, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"std.error"</span>), <span class="at">se_type =</span> <span class="st">"HC2"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(lm_mod_all, <span class="at">se =</span> se_lmmod_all, <span class="at">type=</span><span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                              rprice           
-----------------------------------------------
known_nearinc1             -13,320.150**       
                            (6,785.662)        
                                               
nearinc1                     3,514.141         
                            (7,149.521)        
                                               
as.factor(year)1981        13,093.930***       
                            (2,795.311)        
                                               
age                         -266.338***        
                             (50.716)          
                                               
rooms                      6,969.002***        
                            (1,542.265)        
                                               
area                         23.782***         
                              (3.901)          
                                               
land                           0.127           
                              (0.137)          
                                               
Constant                    -17,688.850        
                           (11,070.580)        
                                               
-----------------------------------------------
Observations                    321            
R2                             0.612           
Adjusted R2                    0.603           
Residual Std. Error    20,857.870 (df = 313)   
F Statistic           70.541*** (df = 7; 313)  
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># isolating the coefficient on the near an incinerator indicator</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>nearinc_coef_cntrlall <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lm_mod_all<span class="sc">$</span>coefficients[<span class="dv">2</span>])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># f-test to test the hypothesis that the coefficients for all of these additional variables are statistically significantly different from 0</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>F_test <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(lm_mod_all, <span class="fu">c</span>(<span class="st">"age = 0"</span>, <span class="st">"rooms = 0"</span>, <span class="st">"area = 0"</span>, <span class="st">"land = 0"</span>), </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">vcov =</span> <span class="fu">vcovHC</span>(lm_mod_all, <span class="at">type =</span> <span class="st">"HC2"</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>F_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
age = 0
rooms = 0
area = 0
land = 0

Model 1: restricted model
Model 2: rprice ~ known_nearinc + nearinc + as.factor(year) + age + rooms + 
    area + land

Note: Coefficient covariance matrix supplied.

  Res.Df Df      F    Pr(&gt;F)    
1    317                        
2    313  4 34.512 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>As seen above as an output of the regression, when we also control for house and lot characteristics, we can see that the causal effect from close proximity to an incinerator on inflation-adjusted housing selling price is much smaller (“, round(nearinc_coef_cntrlall, 2),”) and is no longer statistically significant. This means that the previous models were biased due to omitted variables that were correlated with the other covariates and also the inflation-adjusted housing selling price. We now see that many other house and lot characteristics have a statistically significant causal effect on inflation-adjusted house selling value and since those variables were correlated with houses being near an incinerator, these relationships were previously ‘hidden’ in the incinerator term. The F-test results, as shown above, adjusted for heteroskedastic error also show us that all of the housing and lot characteristics have causal effects statistically significant from 0, with a p value &gt; 0.0005</p>
</section>
</section>
<section id="final-thoughts-on-incinerator-construction-in-north-andover." class="level2">
<h2 class="anchored" data-anchor-id="final-thoughts-on-incinerator-construction-in-north-andover.">Final Thoughts on incinerator construction in North Andover.</h2>
<p>The key assumption underlying the causal interpretation of the DD estimator is the parallel trends assumption. In other words, we assume that the effect of time (1981 vs 1978) on inflation-adjusted house selling values should be the same in the treatment (near incinerators) and control (not near incinerators) if there were no incinerators at play here. In other words, there is no omitted variables bias for time variant variables. We found this to be untrue since there were clearly household attributes (as seen above) that we omitted that led to bias.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{cutler2023,
  author = {Victoria Cutler},
  editor = {},
  title = {Correlation Vs {Causation:} {Air} {Quality} and {Housing}
    {Prices}},
  date = {2023-07-27},
  url = {https://victoriacutler.github.io/posts/correlation-vs-causation/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-cutler2023" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Victoria Cutler. 2023. <span>“Correlation Vs Causation: Air Quality and
Housing Prices.”</span> July 27, 2023. <a href="https://victoriacutler.github.io/posts/correlation-vs-causation/">https://victoriacutler.github.io/posts/correlation-vs-causation/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>